variant: fcos
version: 1.3.0
passwd:
  users:
    - name: core
      ssh_authorized_keys:
        - ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAmErYAR6kJheLcFGU4w5lW2g88u+HdU5jAbaHAzl5QpCThcWWpsr1sNwvFvwPvugwLJ2dXHu3MFMgHesa1R421GAShTFoclMgR+PNM3wDHfYow+K3X2Wnj4QZ2Z6p4GK+OsDObM63irQONsrNqdZ6eMyqUjr9tSE4on9td2Sohb4DCCxEGYltJCVS+jKmnSAK72aSYOY52ey74wSFE1NQ19l7f8o3858YTrNCUBCeV7Ob+pBYU/6dkrz3/dd5fA/OkpgB/RC47/LKhO///ScrpuLfj3ieROMeS3lvL6cP6clq5UzOHbG8q7v3qMsePVzft2hJGojzu5DBhkaPTo/Euw==
systemd:
  units:
    - name: allowsshdport.service
      enabled: true
      contents: |
        [Service]
        Type=oneshot
        ExecStart=semanage port -a -t ssh_port_t -p tcp 8022
        RemainAfterExit=yes
        [Install]
        WantedBy=multi-user.target
# https://computingforgeeks.com/change-ssh-port-centos-rhel-fedora-with-selinux/
# https://serverfault.com/questions/981745/selinux-wont-let-me-run-sshd-under-port-443
# https://docs.fedoraproject.org/en-US/fedora-coreos/faq/
# 
#

storage:
  files:
    - path: /etc/ssh/sshd_config.d/20-set-port.conf
      mode: 0644
      contents:
        inline: |
          Port 8022
